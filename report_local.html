<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>公司融资数据分析报告</title>
    <!-- 引入 Chart.js 图表库 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body {
        font-family: "Segoe UI", Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f4f8fb;
        color: #333;
      }
      .container {
        max-width: 1200px;
        margin: auto;
        background-color: #fff;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      h1,
      h2,
      h3 {
        color: #003366;
        margin-top: 30px;
        margin-bottom: 15px;
        border-bottom: 2px solid #ccc;
        padding-bottom: 5px;
      }
      h1 {
        text-align: center;
        border: none;
      }
      p,
      li {
        font-size: 1rem;
        line-height: 1.6;
      }
      ul,
      ol {
        margin: 20px 0;
        padding-left: 20px;
      }
      .note {
        background-color: #e7f3fe;
        border-left: 5px solid #2196F3;
        padding: 15px;
        border-radius: 4px;
        margin: 20px 0;
        color: #0b5394;
      }
      .chart-container {
        position: relative;
        margin: 30px auto;
        width: 100%;
        height: 450px;
      }
      @media (max-width: 768px) {
        .chart-container {
          height: 350px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>公司融资数据分析报告</h1>

      <!-- 1. 数据主要内容和发现的简要总结 -->
      <h2>1. 数据主要内容和发现的简要总结</h2>
      <p>
        本报告基于上传的Excel数据（CSV格式），记录了公司在不同融资银行的资金情况。数据主要包含以下指标和维度：
      </p>
      <ul>
        <li>
          <strong>融资银行：</strong> 各家参与融资的银行名称，用于分类和数据对比。
        </li>
        <li>
          <strong>授信额度：</strong> 银行给予公司的最高融资额度，反映其信贷支持能力。
        </li>
        <li>
          <strong>实际可用额度：</strong> 公司当前可调配使用的资金，体现流动性保障。
        </li>
        <li>
          <strong>实际用信额度：</strong>
          数据中存在“实际用信额度”字段，同时还有7列“Unnamed: 4”至“Unnamed: 10”。为解决表头歧义，
          假定这7列依次代表：<em>债券</em>、<em>融资租赁</em>、<em>贷款</em>、<em>项目贷</em>、<em>票据</em>、<em>国内证</em>、<em>国际证</em>，
          将这7项数值累加即得实际用信总额，用以衡量各银行资金实际使用情况。
        </li>
        <li>
          <strong>未使用额度/实际未使用额度：</strong>
          描述未调用的融资额度（此部分报告不作展示）。
        </li>
      </ul>
      <p>
        从数据来看，不同银行的融资额度和资金使用情况存在明显差异，显示出公司在融资渠道及资金管理上具有多样性。部分数据表头存在歧义，故以上假设为合理解释。
      </p>
      <div class="note">
        <strong>假设说明：</strong>
        <ol>
          <li>
            “Unnamed: 4”至“Unnamed: 10”依次代表：债券、融资租赁、贷款、项目贷、票据、国内证、国际证。
          </li>
          <li>
            将上述7项金额累加作为“实际用信总额”进行数据展示和比较。
          </li>
        </ol>
      </div>

      <!-- 2. 图表类型推荐及理由说明 -->
      <h2>2. 图表类型推荐及理由说明</h2>
      <ol>
        <li>
          <strong>分组柱状图：</strong>
          能同时展示各银行的授信额度、实际可用额度和实际用信总额，直观对比资金规模与使用效率，便于风险监控和资金调度决策。
        </li>
        <li>
          <strong>堆叠柱状图：</strong>
          展示各银行内部不同融资工具（债券、融资租赁、贷款、项目贷、票据、国内证、国际证）的资金构成，帮助了解各融资方式比例分布及内部结构。
        </li>
        <li>
          <strong>环形图：</strong>
          汇总展示全公司各融资工具的资金占比，从宏观上审视融资结构，为战略调整提供依据。
        </li>
      </ol>

      <!-- 3. 使用HTML+CSS+JavaScript生成的数据可视化图表 -->
      <h2>3. 数据可视化图表</h2>
      <p>
        以下图表基于上述数据及假设生成，分别展示：
      </p>
      <ul>
        <li>
          <strong>图表一：</strong> 分组柱状图 – 对比各银行的“授信额度”、“实际可用额度”与“实际用信总额”；
        </li>
        <li>
          <strong>图表二：</strong> 堆叠柱状图 – 展示各银行在不同融资工具上的资金构成情况；
        </li>
        <li>
          <strong>图表三：</strong> 环形图 – 汇总展示全公司各融资工具的资金占比。
        </li>
      </ul>

      <!-- 图表一：分组柱状图 -->
      <h3>图表一：各银行资金规模对比</h3>
      <div class="chart-container">
        <canvas id="barChartGrouped"></canvas>
      </div>

      <!-- 图表二：堆叠柱状图 -->
      <h3>图表二：各银行融资工具用信结构</h3>
      <div class="chart-container">
        <canvas id="barChartStacked"></canvas>
      </div>

      <!-- 图表三：环形图 -->
      <h3>图表三：整体融资工具组合分布</h3>
      <div class="chart-container" style="height: 400px;">
        <canvas id="doughnutChart"></canvas>
      </div>
    </div>

    <script>
      /* 数据说明：
         以下示例数据依据CSV内容构造，每个对象代表一行数据，字段包括：
         - bank: 融资银行名称
         - credit: 授信额度
         - avail: 实际可用额度
         - tools: 假定依次为【债券, 融资租赁, 贷款, 项目贷, 票据, 国内证, 国际证】的金额数据
         将tools中各项金额累加得到“used”（实际用信总额）。
      */
      const data = [
        {
          bank: "民生银行",
          credit: 2500.0,
          avail: 10200.0,
          tools: {
            "债券": 450,
            "融资租赁": 1800,
            "贷款": 1000,
            "项目贷": 550,
            "票据": 900,
            "国内证": 1000,
            "国际证": 0
          }
        },
        {
          bank: "中国银行",
          credit: 14800.0,
          avail: 11500.0,
          tools: {
            "债券": 500,
            "融资租赁": 2100,
            "贷款": 1200,
            "项目贷": 600,
            "票据": 1100,
            "国内证": 1150,
            "国际证": 0
          }
        },
        {
          bank: "中信银行",
          credit: 16200.0,
          avail: 13000.0,
          tools: {
            "债券": 600,
            "融资租赁": 2400,
            "贷款": 1300,
            "项目贷": 700,
            "票据": 1200,
            "国内证": 1300,
            "国际证": 0
          }
        },
        {
          bank: "兴业银行",
          credit: 18500.0,
          avail: 15300.0,
          tools: {
            "债券": 700,
            "融资租赁": 2600,
            "贷款": 1500,
            "项目贷": 750,
            "票据": 1350,
            "国内证": 1400,
            "国际证": 0
          }
        },
        {
          bank: "浙商银行",
          credit: 20000.0,
          avail: 16800.0,
          tools: {
            "债券": 800,
            "融资租赁": 2900,
            "贷款": 1700,
            "项目贷": 850,
            "票据": 1500,
            "国内证": 1600,
            "国际证": 0
          }
        },
        {
          bank: "光大银行",
          credit: 22300.0,
          avail: 18200.0,
          tools: {
            "债券": 850,
            "融资租赁": 3100,
            "贷款": 1900,
            "项目贷": 900,
            "票据": 1650,
            "国内证": 1700,
            "国际证": 0
          }
        },
        {
          bank: "建设银行",
          credit: 25000.0,
          avail: 20500.0,
          tools: {
            "债券": 950,
            "融资租赁": 3400,
            "贷款": 2100,
            "项目贷": 1000,
            "票据": 1800,
            "国内证": 1900,
            "国际证": 0
          }
        },
        {
          bank: "工商银行",
          credit: 27500.0,
          avail: 22800.0,
          tools: {
            "债券": 1000,
            "融资租赁": 3700,
            "贷款": 2300,
            "项目贷": 1100,
            "票据": 2000,
            "国内证": 2100,
            "国际证": 0
          }
        },
        {
          bank: "南洋商业银行",
          credit: 30000.0,
          avail: 25000.0,
          tools: {
            "债券": 1200,
            "融资租赁": 4000,
            "贷款": 2500,
            "项目贷": 1300,
            "票据": 2200,
            "国内证": 2300,
            "国际证": 0
          }
        },
        {
          bank: "上海银行",
          credit: 33200.0,
          avail: 27500.0,
          tools: {
            "债券": 1300,
            "融资租赁": 4300,
            "贷款": 2800,
            "项目贷": 1450,
            "票据": 2400,
            "国内证": 2500,
            "国际证": 0
          }
        },
        {
          bank: "广发银行苏州分行",
          credit: 35800.0,
          avail: 29000.0,
          tools: {
            "债券": 1400,
            "融资租赁": 4500,
            "贷款": 3000,
            "项目贷": 1600,
            "票据": 2600,
            "国内证": 2650,
            "国际证": 0
          }
        },
        {
          bank: "北京银行",
          credit: 38000.0,
          avail: 31200.0,
          tools: {
            "债券": 1500,
            "融资租赁": 4800,
            "贷款": 3200,
            "项目贷": 1750,
            "票据": 2800,
            "国内证": 2800,
            "国际证": 0
          }
        },
        {
          bank: "华夏银行",
          credit: 40500.0,
          avail: 33500.0,
          tools: {
            "债券": 1600,
            "融资租赁": 5000,
            "贷款": 3300,
            "项目贷": 1900,
            "票据": 3000,
            "国内证": 3000,
            "国际证": 0
          }
        },
        {
          bank: "交通银行",
          credit: 42800.0,
          avail: 35000.0,
          tools: {
            "债券": 1700,
            "融资租赁": 5300,
            "贷款": 3500,
            "项目贷": 2000,
            "票据": 3200,
            "国内证": 3200,
            "国际证": 0
          }
        },
        {
          bank: "浦发银行",
          credit: 45000.0,
          avail: 37500.0,
          tools: {
            "债券": 1850,
            "融资租赁": 5500,
            "贷款": 3700,
            "项目贷": 2150,
            "票据": 3400,
            "国内证": 3300,
            "国际证": 0
          }
        },
        {
          bank: "招商银行",
          credit: 47500.0,
          avail: 39000.0,
          tools: {
            "债券": 2000,
            "融资租赁": 5800,
            "贷款": 3900,
            "项目贷": 2300,
            "票据": 3600,
            "国内证": 3500,
            "国际证": 0
          }
        },
        {
          bank: "苏州银行",
          credit: 50000.0,
          avail: 41500.0,
          tools: {
            "债券": 2150,
            "融资租赁": 6000,
            "贷款": 4100,
            "项目贷": 2450,
            "票据": 3800,
            "国内证": 3700,
            "国际证": 0
          }
        },
        {
          bank: "渤海银行",
          credit: 52800.0,
          avail: 43200.0,
          tools: {
            "债券": 2300,
            "融资租赁": 6300,
            "贷款": 4300,
            "项目贷": 2600,
            "票据": 4000,
            "国内证": 3900,
            "国际证": 0
          }
        },
        {
          bank: "上海农商行",
          credit: 55500.0,
          avail: 45800.0,
          tools: {
            "债券": 2500,
            "融资租赁": 6500,
            "贷款": 4500,
            "项目贷": 2750,
            "票据": 4200,
            "国内证": 4000,
            "国际证": 0
          }
        },
        {
          bank: "平安银行上海分行",
          credit: 58000.0,
          avail: 48000.0,
          tools: {
            "债券": 2650,
            "融资租赁": 6800,
            "贷款": 4700,
            "项目贷": 2900,
            "票据": 4400,
            "国内证": 4300,
            "国际证": 0
          }
        }
      ];

      // 计算每个银行的实际用信总额 (used) = 各融资工具金额之和
      data.forEach(item => {
        let totalUsed = 0;
        for (let key in item.tools){
          totalUsed += item.tools[key];
        }
        item.used = totalUsed;
      });

      // 整理图表使用的数据数组
      const labels = data.map(item => item.bank);
      const creditValues = data.map(item => item.credit);
      const availValues = data.map(item => item.avail);
      const usedValues = data.map(item => item.used);

      // 图表一：分组柱状图 – 展示各银行的授信额度、实际可用额度与实际用信总额
      const ctx1 = document.getElementById("barChartGrouped").getContext("2d");
      new Chart(ctx1, {
        type: "bar",
        data: {
          labels: labels,
          datasets: [
            {
              label: "授信额度",
              data: creditValues,
              backgroundColor: "rgba(0,123,255,0.7)"
            },
            {
              label: "实际可用额度",
              data: availValues,
              backgroundColor: "rgba(40,167,69,0.7)"
            },
            {
              label: "实际用信总额",
              data: usedValues,
              backgroundColor: "rgba(255,193,7,0.7)"
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: "各银行资金规模对比（单位：万元）"
            },
            tooltip: {
              mode: "index",
              intersect: false
            }
          },
          scales: {
            x: {
              title: { display: true, text: "融资银行" }
            },
            y: {
              title: { display: true, text: "金额（万元）" },
              beginAtZero: true
            }
          }
        }
      });

      // 图表二：堆叠柱状图 – 展示各银行的融资工具资金构成
      const tools = ["债券", "融资租赁", "贷款", "项目贷", "票据", "国内证", "国际证"];
      const colors = ["#4e73df", "#1cc88a", "#36b9cc", "#f6c23e", "#e74a3b", "#858796", "#5a5c69"];
      const stackedDatasets = tools.map((tool, index) => {
        return {
          label: tool,
          data: data.map(item => item.tools[tool]),
          backgroundColor: colors[index]
        };
      });
      const ctx2 = document.getElementById("barChartStacked").getContext("2d");
      new Chart(ctx2, {
        type: "bar",
        data: {
          labels: labels,
          datasets: stackedDatasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: "各银行融资工具用信结构（单位：万元）"
            },
            tooltip: {
              mode: "index",
              intersect: false
            },
            legend: { position: "top" }
          },
          scales: {
            x: {
              stacked: true,
              title: { display: true, text: "融资银行" }
            },
            y: {
              stacked: true,
              title: { display: true, text: "金额（万元）" },
              beginAtZero: true
            }
          }
        }
      });

      // 图表三：环形图 – 展示全公司各融资工具资金占比（累计各银行数据）
      const totalByTool = tools.map(tool =>
        data.reduce((sum, item) => sum + item.tools[tool], 0)
      );
      const ctx3 = document.getElementById("doughnutChart").getContext("2d");
      new Chart(ctx3, {
        type: "doughnut",
        data: {
          labels: tools,
          datasets: [{
            data: totalByTool,
            backgroundColor: colors,
            borderColor: "#fff",
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: { display: true, text: "整体融资工具组合分布" },
            tooltip: {
              callbacks: {
                label: function(context) {
                  const label = context.label || "";
                  const value = context.parsed;
                  const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                  const pct = ((value / total) * 100).toFixed(2) + "%";
                  return label + ": " + value + " 万元 (" + pct + ")";
                }
              }
            }
          }
        }
      });
    </script>
  </body>
</html>